<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Boundary Value Problems · BoundaryValueDiffEq.jl</title><meta name="title" content="Boundary Value Problems · BoundaryValueDiffEq.jl"/><meta property="og:title" content="Boundary Value Problems · BoundaryValueDiffEq.jl"/><meta property="twitter:title" content="Boundary Value Problems · BoundaryValueDiffEq.jl"/><meta name="description" content="Documentation for BoundaryValueDiffEq.jl."/><meta property="og:description" content="Documentation for BoundaryValueDiffEq.jl."/><meta property="twitter:description" content="Documentation for BoundaryValueDiffEq.jl."/><meta property="og:url" content="https://docs.sciml.ai/BoundaryValueDiffEq/stable/basics/bvp_problem/"/><meta property="twitter:url" content="https://docs.sciml.ai/BoundaryValueDiffEq/stable/basics/bvp_problem/"/><link rel="canonical" href="https://docs.sciml.ai/BoundaryValueDiffEq/stable/basics/bvp_problem/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="BoundaryValueDiffEq.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">BoundaryValueDiffEq.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">BoundaryValueDiffEq.jl: High-Performance Bounday Value Problem Solvers</a></li><li><a class="tocitem" href="../../tutorials/getting_started/">Getting Started with BVP solving in Julia</a></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../../tutorials/continuation/">Solve BVP with Continuation</a></li><li><a class="tocitem" href="../../tutorials/solve_nlls_bvp/">Solve Overdetermined and Underdetermined BVP</a></li><li><a class="tocitem" href="../../tutorials/unknown_parameters/">Estimate Unknown Parameters in BVP</a></li><li><a class="tocitem" href="../../tutorials/extremum/">Solve BVP with Extremum Boundary Conditions</a></li></ul></li><li><span class="tocitem">Basics</span><ul><li class="is-active"><a class="tocitem" href>Boundary Value Problems</a><ul class="internal"><li><a class="tocitem" href="#The-Five-Types-of-Boundary-Value-Problems"><span>The Five Types of Boundary Value Problems</span></a></li><li><a class="tocitem" href="#Problem-Construction-Details"><span>Problem Construction Details</span></a></li></ul></li><li><a class="tocitem" href="../bvp_functions/">BVP Functions and Jacobian Types</a></li><li><a class="tocitem" href="../solve/">Common Solver Options (Solve Keyword Arguments)</a></li><li><a class="tocitem" href="../autodiff/">Automatic Differentiation Backends</a></li><li><a class="tocitem" href="../error_control/">Error Control Adaptivity</a></li></ul></li><li><span class="tocitem">Solver Summaries and Recommendations</span><ul><li><a class="tocitem" href="../../solvers/mirk/">BoundaryValueDiffEqMIRK</a></li><li><a class="tocitem" href="../../solvers/firk/">BoundaryValueDiffEqFIRK</a></li><li><a class="tocitem" href="../../solvers/shooting/">BoundaryValueDiffEqShooting</a></li><li><a class="tocitem" href="../../solvers/mirkn/">BoundaryValueDiffEqMIRKN</a></li><li><a class="tocitem" href="../../solvers/ascher/">BoundaryValueDiffEqAscher</a></li><li><a class="tocitem" href="../../solvers/simple_solvers/">SimpleBoundaryValueDiffEq</a></li><li><a class="tocitem" href="../../solvers/wrappers/">Wrapper Methods</a></li></ul></li><li><span class="tocitem">Wrapped Solver APIs</span><ul><li><a class="tocitem" href="../../api/odeinterface/">ODEInterface.jl</a></li></ul></li><li><span class="tocitem">Development Documentation</span><ul><li><a class="tocitem" href="../../devdocs/internal_interfaces/">Internal Abstract Types</a></li></ul></li><li><a class="tocitem" href="../../references/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Basics</a></li><li class="is-active"><a href>Boundary Value Problems</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Boundary Value Problems</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/SciML/BoundaryValueDiffEq.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/SciML/BoundaryValueDiffEq.jl/blob/master/docs/src/basics/bvp_problem.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="problems"><a class="docs-heading-anchor" href="#problems">Boundary Value Problems</a><a id="problems-1"></a><a class="docs-heading-anchor-permalink" href="#problems" title="Permalink"></a></h1><h2 id="The-Five-Types-of-Boundary-Value-Problems"><a class="docs-heading-anchor" href="#The-Five-Types-of-Boundary-Value-Problems">The Five Types of Boundary Value Problems</a><a id="The-Five-Types-of-Boundary-Value-Problems-1"></a><a class="docs-heading-anchor-permalink" href="#The-Five-Types-of-Boundary-Value-Problems" title="Permalink"></a></h2><p>BoundaryValueDiffEq.jl tackles five related types of boundary value problems:</p><ol><li>General boundary value problems:, i.e., constraints are applied over the time span. Both overconstraints and underconstraints BVP are supported.</li><li>Two-point boundary value problems:, i.e., constraints are only applied at start and end of time span. Both overconstraints and underconstraints BVP are supported.</li><li>General second order boundary value problems, i.e., constraints for both solution and derivative of solution are applied over time span. Both overconstraints and underconstraints second order BVP are supported.</li><li>Second order two-point boundary value problems, i.e., constraints for both solution and derivative of solution are only applied at the start and end of the time span. Both overconstraints and underconstraints second order BVP are supported.</li><li>Boundary value differential algebraic equations, i.e., apart from constraints applied over the time span, BVDAE has additional algebraic equations which state the algebraic relationship of different states in BVDAE.</li></ol><h2 id="Problem-Construction-Details"><a class="docs-heading-anchor" href="#Problem-Construction-Details">Problem Construction Details</a><a id="Problem-Construction-Details-1"></a><a class="docs-heading-anchor-permalink" href="#Problem-Construction-Details" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SciMLBase.BVProblem" href="#SciMLBase.BVProblem"><code>SciMLBase.BVProblem</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Defines an BVP problem. Documentation Page: <a href="https://docs.sciml.ai/DiffEqDocs/stable/types/bvp_types/">https://docs.sciml.ai/DiffEqDocs/stable/types/bvp_types/</a></p><p><strong>Mathematical Specification of a BVP Problem</strong></p><p>To define a BVP Problem, you simply need to give the function <span>$f$</span> and the initial condition <span>$u_0$</span> which define an ODE:</p><p class="math-container">\[\frac{du}{dt} = f(u,p,t)\]</p><p>along with an implicit function <code>bc</code> which defines the residual equation, where</p><p class="math-container">\[bc(u,p,t) = 0\]</p><p>is the manifold on which the solution must live. A common form for this is the two-point <code>BVProblem</code> where the manifold defines the solution at two points:</p><p class="math-container">\[u(t_0) = a
u(t_f) = b\]</p><p><strong>Problem Type</strong></p><p><strong>Constructors</strong></p><pre><code class="language-julia hljs">TwoPointBVProblem{isinplace}(f, bc, u0, tspan, p=NullParameters(); kwargs...)
BVProblem{isinplace}(f, bc, u0, tspan, p=NullParameters(); kwargs...)</code></pre><p>or if we have an initial guess function <code>initialGuess(p, t)</code> for the given BVP, we can pass the initial guess to the problem constructors:</p><pre><code class="language-julia hljs">TwoPointBVProblem{isinplace}(f, bc, initialGuess, tspan, p=NullParameters(); kwargs...)
BVProblem{isinplace}(f, bc, initialGuess, tspan, p=NullParameters(); kwargs...)</code></pre><p>For any BVP problem type, <code>bc</code> must be inplace if <code>f</code> is inplace. Otherwise it must be out-of-place.</p><p>If the bvp is a StandardBVProblem (also known as a Multi-Point BV Problem) it must define either of the following functions</p><pre><code class="language-julia hljs">bc!(residual, u, p, t)
residual = bc(u, p, t)</code></pre><p>where <code>residual</code> computed from the current <code>u</code>. <code>u</code> is an array of solution values where <code>u[i]</code> is at time <code>t[i]</code>, while <code>p</code> are the parameters. For a <code>TwoPointBVProblem</code>, <code>t = tspan</code>. For the more general <code>BVProblem</code>, <code>u</code> can be all of the internal time points, and for shooting type methods <code>u=sol</code> the ODE solution. Note that all features of the <code>ODESolution</code> are present in this form. In both cases, the size of the residual matches the size of the initial condition.</p><p>If the bvp is a TwoPointBVProblem then <code>bc</code> must be a Tuple <code>(bca, bcb)</code> and each of them must define either of the following functions:</p><pre><code class="language-julia hljs">begin
    bca!(resid_a, u_a, p)
    bcb!(resid_b, u_b, p)
end
begin
    resid_a = bca(u_a, p)
    resid_b = bcb(u_b, p)
end</code></pre><p>where <code>resid_a</code> and <code>resid_b</code> are the residuals at the two endpoints, <code>u_a</code> and <code>u_b</code> are the solution values at the two endpoints, and <code>p</code> are the parameters.</p><p>Parameters are optional, and if not given, then a <code>NullParameters()</code> singleton will be used which will throw nice errors if you try to index non-existent parameters. Any extra keyword arguments are passed on to the solvers. For example, if you set a <code>callback</code> in the problem, then that <code>callback</code> will be added in every solve call.</p><p><strong>Fields</strong></p><ul><li><code>f</code>: The function for the ODE.</li><li><code>bc</code>: The boundary condition function.</li><li><code>u0</code>: The initial condition. Either the initial condition for the ODE as an initial value problem, or a <code>Vector</code> of values for <span>$u(t_i)$</span> for collocation methods.</li><li><code>tspan</code>: The timespan for the problem.</li><li><code>p</code>: The parameters for the problem. Defaults to <code>NullParameters</code></li><li><code>kwargs</code>: The keyword arguments passed onto the solves.</li></ul><p><strong>Special Keyword Arguments</strong></p><ul><li><code>nlls</code>: Specify that the BVP is a nonlinear least squares problem. Use <code>Val(true)</code> or <code>Val(false)</code> for type stability. By default this is automatically inferred based on the size of the input and outputs, however this is type unstable for any array type that doesn&#39;t store array size as part of type information. If we can&#39;t reliably infer this, we set it to <code>Nothing</code>. Downstreams solvers must be setup to deal with this case.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SciML/SciMLBase.jl/blob/v2.102.1/src/problems/bvp_problems.jl#L11">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SciMLBase.TwoPointBVProblem" href="#SciMLBase.TwoPointBVProblem"><code>SciMLBase.TwoPointBVProblem</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">struct TwoPointBVProblem{iip}</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SciML/SciMLBase.jl/blob/v2.102.1/src/problems/bvp_problems.jl#L6">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SciMLBase.SecondOrderBVProblem" href="#SciMLBase.SecondOrderBVProblem"><code>SciMLBase.SecondOrderBVProblem</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Defines a second order BVP problem. Documentation Page: <a href="https://docs.sciml.ai/DiffEqDocs/stable/types/bvp_types/">https://docs.sciml.ai/DiffEqDocs/stable/types/bvp_types/</a></p><p><strong>Mathematical Specification of a second order BVP Problem</strong></p><p>To define a second order BVP Problem, you simply need to give the function <span>$f$</span> and the initial condition <span>$u_0$</span> which define an ODE:</p><p class="math-container">\[\frac{ddu}{dt} = f(du,u,p,t)\]</p><p>along with an implicit function <code>bc</code> which defines the residual equation, where</p><p class="math-container">\[bc(du,u,p,t) = 0\]</p><p>is the manifold on which the solution must live. A common form for this is the two-point <code>SecondOrderBVProblem</code> where the manifold defines the solution at two points:</p><p class="math-container">\[g(u(t_0),u&#39;(t_0)) = 0
g(u(t_f),u&#39;(t_f)) = 0\]</p><p><strong>Problem Type</strong></p><p><strong>Constructors</strong></p><pre><code class="language-julia hljs">TwoPointSecondOrderBVProblem{isinplace}(f, bc, u0, tspan, p=NullParameters(); kwargs...)
SecondOrderBVProblem{isinplace}(f, bc, u0, tspan, p=NullParameters(); kwargs...)</code></pre><p>or if we have an initial guess function <code>initialGuess(p, t)</code> for the given BVP, we can pass the initial guess to the problem constructors:</p><pre><code class="language-julia hljs">TwoPointSecondOrderBVProblem{isinplace}(f, bc, initialGuess, tspan, p=NullParameters(); kwargs...)
SecondOrderBVProblem{isinplace}(f, bc, initialGuess, tspan, p=NullParameters(); kwargs...)</code></pre><p>For any BVP problem type, <code>bc</code> must be inplace if <code>f</code> is inplace. Otherwise it must be out-of-place.</p><p>If the bvp is a StandardSecondOrderBVProblem (also known as a Multi-Point BV Problem) it must define either of the following functions</p><pre><code class="language-julia hljs">bc!(residual, du, u, p, t)
residual = bc(du, u, p, t)</code></pre><p>where <code>residual</code> computed from the current <code>u</code>. <code>u</code> is an array of solution values where <code>u[i]</code> is at time <code>t[i]</code>, while <code>p</code> are the parameters. For a <code>TwoPointBVProblem</code>, <code>t = tspan</code>. For the more general <code>BVProblem</code>, <code>u</code> can be all of the internal time points, and for shooting type methods <code>u=sol</code> the ODE solution. Note that all features of the <code>ODESolution</code> are present in this form. In both cases, the size of the residual matches the size of the initial condition.</p><p>If the bvp is a <code>TwoPointSecondOrderBVProblem</code> then <code>bc</code> must be a Tuple <code>(bca, bcb)</code> and each of them must define either of the following functions:</p><pre><code class="language-julia hljs">begin
    bca!(resid_a, du_a, u_a, p)
    bcb!(resid_b, du_b, u_b, p)
end
begin
    resid_a = bca(du_a, u_a, p)
    resid_b = bcb(du_b, u_b, p)
end</code></pre><p>where <code>resid_a</code> and <code>resid_b</code> are the residuals at the two endpoints, <code>u_a</code> and <code>u_b</code> are the solution values at the two endpoints, <code>du_a</code> and <code>du_b</code> are the derivative of solution values at the two endpoints, and <code>p</code> are the parameters.</p><p>Parameters are optional, and if not given, then a <code>NullParameters()</code> singleton will be used which will throw nice errors if you try to index non-existent parameters. Any extra keyword arguments are passed on to the solvers. For example, if you set a <code>callback</code> in the problem, then that <code>callback</code> will be added in every solve call.</p><p><strong>Fields</strong></p><ul><li><code>f</code>: The function for the ODE.</li><li><code>bc</code>: The boundary condition function.</li><li><code>u0</code>: The initial condition. Either the initial condition for the ODE as an initial value problem, or a <code>Vector</code> of values for <span>$u(t_i)$</span> for collocation methods.</li><li><code>tspan</code>: The timespan for the problem.</li><li><code>p</code>: The parameters for the problem. Defaults to <code>NullParameters</code></li><li><code>kwargs</code>: The keyword arguments passed onto the solves.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SciML/SciMLBase.jl/blob/v2.102.1/src/problems/bvp_problems.jl#L249">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SciMLBase.TwoPointSecondOrderBVProblem" href="#SciMLBase.TwoPointSecondOrderBVProblem"><code>SciMLBase.TwoPointSecondOrderBVProblem</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">struct TwoPointSecondOrderBVProblem{iip}</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SciML/SciMLBase.jl/blob/v2.102.1/src/problems/bvp_problems.jl#L244">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../tutorials/extremum/">« Solve BVP with Extremum Boundary Conditions</a><a class="docs-footer-nextpage" href="../bvp_functions/">BVP Functions and Jacobian Types »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.13.0 on <span class="colophon-date" title="Saturday 28 June 2025 07:55">Saturday 28 June 2025</span>. Using Julia version 1.10.9.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
