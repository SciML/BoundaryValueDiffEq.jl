<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Solve Overdetermined and Underdetermined BVP · BoundaryValueDiffEq.jl</title><meta name="title" content="Solve Overdetermined and Underdetermined BVP · BoundaryValueDiffEq.jl"/><meta property="og:title" content="Solve Overdetermined and Underdetermined BVP · BoundaryValueDiffEq.jl"/><meta property="twitter:title" content="Solve Overdetermined and Underdetermined BVP · BoundaryValueDiffEq.jl"/><meta name="description" content="Documentation for BoundaryValueDiffEq.jl."/><meta property="og:description" content="Documentation for BoundaryValueDiffEq.jl."/><meta property="twitter:description" content="Documentation for BoundaryValueDiffEq.jl."/><meta property="og:url" content="https://docs.sciml.ai/BoundaryValueDiffEq/stable/tutorials/solve_nlls_bvp/"/><meta property="twitter:url" content="https://docs.sciml.ai/BoundaryValueDiffEq/stable/tutorials/solve_nlls_bvp/"/><link rel="canonical" href="https://docs.sciml.ai/BoundaryValueDiffEq/stable/tutorials/solve_nlls_bvp/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="BoundaryValueDiffEq.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">BoundaryValueDiffEq.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">BoundaryValueDiffEq.jl: High-Performance Boundary Value Problem Solvers</a></li><li><a class="tocitem" href="../getting_started/">Getting Started with BVP solving in Julia</a></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../continuation/">Solve BVP with Continuation</a></li><li class="is-active"><a class="tocitem" href>Solve Overdetermined and Underdetermined BVP</a><ul class="internal"><li><a class="tocitem" href="#Solve-Overdetermined-BVP"><span>Solve Overdetermined BVP</span></a></li><li><a class="tocitem" href="#Solve-Underdetermined-BVP"><span>Solve Underdetermined BVP</span></a></li></ul></li><li><a class="tocitem" href="../unknown_parameters/">Estimate Unknown Parameters in BVP</a></li><li><a class="tocitem" href="../optimal_control/">Solve Dynamical Optimization problem</a></li><li><a class="tocitem" href="../extremum/">Solve BVP with Extremum Boundary Conditions</a></li></ul></li><li><span class="tocitem">Basics</span><ul><li><a class="tocitem" href="../../basics/bvp_problem/">Boundary Value Problems</a></li><li><a class="tocitem" href="../../basics/bvp_functions/">BVP Functions and Jacobian Types</a></li><li><a class="tocitem" href="../../basics/solve/">Common Solver Options (Solve Keyword Arguments)</a></li><li><a class="tocitem" href="../../basics/autodiff/">Automatic Differentiation Backends</a></li><li><a class="tocitem" href="../../basics/error_control/">Error Control Adaptivity</a></li></ul></li><li><span class="tocitem">Solver Summaries and Recommendations</span><ul><li><a class="tocitem" href="../../solvers/mirk/">BoundaryValueDiffEqMIRK</a></li><li><a class="tocitem" href="../../solvers/firk/">BoundaryValueDiffEqFIRK</a></li><li><a class="tocitem" href="../../solvers/shooting/">BoundaryValueDiffEqShooting</a></li><li><a class="tocitem" href="../../solvers/mirkn/">BoundaryValueDiffEqMIRKN</a></li><li><a class="tocitem" href="../../solvers/ascher/">BoundaryValueDiffEqAscher</a></li><li><a class="tocitem" href="../../solvers/simple_solvers/">SimpleBoundaryValueDiffEq</a></li><li><a class="tocitem" href="../../solvers/wrappers/">Wrapper Methods</a></li></ul></li><li><span class="tocitem">Wrapped Solver APIs</span><ul><li><a class="tocitem" href="../../api/odeinterface/">ODEInterface.jl</a></li></ul></li><li><span class="tocitem">Development Documentation</span><ul><li><a class="tocitem" href="../../devdocs/internal_interfaces/">Internal Abstract Types</a></li></ul></li><li><a class="tocitem" href="../../references/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Tutorials</a></li><li class="is-active"><a href>Solve Overdetermined and Underdetermined BVP</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Solve Overdetermined and Underdetermined BVP</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/SciML/BoundaryValueDiffEq.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/SciML/BoundaryValueDiffEq.jl/blob/master/docs/src/tutorials/solve_nlls_bvp.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Solve-Overdetermined-and-Underdetermined-BVP"><a class="docs-heading-anchor" href="#Solve-Overdetermined-and-Underdetermined-BVP">Solve Overdetermined and Underdetermined BVP</a><a id="Solve-Overdetermined-and-Underdetermined-BVP-1"></a><a class="docs-heading-anchor-permalink" href="#Solve-Overdetermined-and-Underdetermined-BVP" title="Permalink"></a></h1><p>When there are more or less boundary conditions than the states in a boundary value problem, the BVP would become an overdetermined or underdetermined boundary value problem. As for these kinds of special BVPs, the solving workflow are similar with solving standard BVPs in BoundaryValueDiffEq.jl, but we need to specify the prototype of boundary conditions to tell BoundaryValueDiffEq.jl the structure of our boundary conditions with <code>bcresid_prototype</code> in <code>BVPFunction</code>.</p><h2 id="Solve-Overdetermined-BVP"><a class="docs-heading-anchor" href="#Solve-Overdetermined-BVP">Solve Overdetermined BVP</a><a id="Solve-Overdetermined-BVP-1"></a><a class="docs-heading-anchor-permalink" href="#Solve-Overdetermined-BVP" title="Permalink"></a></h2><p>For example, consider an overdetermined BVP given by the system of differential equations</p><p class="math-container">\[\begin{align*}
y_1&#39; &amp;=  y_2 \\
y_2&#39; &amp;= -y_1
\end{align*}\]</p><p>with boundary conditions of</p><p class="math-container">\[\begin{align*}
y_1(0) &amp;= 0, \\
y_1(100) &amp;= 1, \\
y_2(100) &amp;= -1.729109
\end{align*}\]</p><p>The test BVP has two state variables but three boundary conditions, which means there are additional constraints on the solution.</p><pre><code class="language-julia hljs">using BoundaryValueDiffEq, Plots
function f!(du, u, p, t)
    du[1] = u[2]
    du[2] = -u[1]
end
function bc!(resid, sol, p, t)
    solₜ₁ = sol(0.0)
    solₜ₂ = sol(100.0)
    resid[1] = solₜ₁[1]
    resid[2] = solₜ₂[1] - 1
    resid[3] = solₜ₂[2] + 1.729109
end
tspan = (0.0, 100.0)
u0 = [0.0, 1.0]
prob = BVProblem(BVPFunction(f!, bc!; bcresid_prototype = zeros(3)), u0, tspan)
sol = solve(prob, MIRK4(), dt = 0.01, abstol = 1e-3)
plot(sol)</code></pre><img src="76661649.svg" alt="Example block output"/><p>Since this BVP imposes constraints only at the two endpoints, we can use <code>TwoPointBVProblem</code> to handle such cases.</p><pre><code class="language-julia hljs">function f!(du, u, p, t)
    du[1] = u[2]
    du[2] = -u[1]
end
bca!(resid, ua, p) = (resid[1] = ua[1])
bcb!(resid, ub, p) = (resid[1] = ub[1] - 1; resid[2] = ub[2] + 1.729109)
bvpfun = BVPFunction(f!, (bca!, bcb!); twopoint = Val(true),
    bcresid_prototype = (zeros(1), zeros(2)))
prob = TwoPointBVProblem(bvpfun, u0, tspan)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi"><span class="sgr38_2" style="color:#56b6c2">BVProblem</span> with uType <span class="sgr38_2" style="color:#56b6c2">Vector{Float64}</span> and tType <span class="sgr38_2" style="color:#56b6c2">Float64</span>. In-place: <span class="sgr38_2" style="color:#56b6c2">true</span>
Non-trivial mass matrix: <span class="sgr38_2" style="color:#56b6c2">false</span>
timespan: (0.0, 100.0)
u0: 2-element Vector{Float64}:
 0.0
 1.0</code></pre><h2 id="Solve-Underdetermined-BVP"><a class="docs-heading-anchor" href="#Solve-Underdetermined-BVP">Solve Underdetermined BVP</a><a id="Solve-Underdetermined-BVP-1"></a><a class="docs-heading-anchor-permalink" href="#Solve-Underdetermined-BVP" title="Permalink"></a></h2><p>Let&#39;s see an example of underdetermined BVP, consider an horizontal metal beam of length <span>$L$</span> subject to a vertical load <span>$q(x)$</span> per unit length, the resulting beam displacement satisfies the differential equation</p><p class="math-container">\[EIy&#39;(x)=q(x)\]</p><p>with boundary condition <span>$y(0)=y(L)=0$</span>, <span>$E$</span> is the Young&#39;s modulus and <span>$I$</span> is the moment of inertia of the beam&#39;s cross section. Here we consider the simplified version and transform this BVP into a first order BVP system:</p><p class="math-container">\[\begin{align*}
y_1&#39; &amp;= y_2\\
y_2&#39; &amp;= y_3\\
y_3&#39; &amp;= y_4\\
y_4&#39; &amp;= 0
\end{align*}\]</p><pre><code class="language-julia hljs">using BoundaryValueDiffEq, Plots
function f!(du, u, p, t)
    du[1] = u[2]
    du[2] = u[3]
    du[3] = u[4]
    du[4] = 0
end
function bc!(resid, sol, p, t)
    solₜ₁ = sol(0.0)
    solₜ₂ = sol(1.0)
    resid[1] = solₜ₁[1]
    resid[2] = solₜ₂[1]
end
xspan = (0.0, 1.0)
u0 = [0.0, 1.0, 0.0, 1.0]
prob = BVProblem(BVPFunction(f!, bc!; bcresid_prototype = zeros(2)), u0, xspan)
sol = solve(prob, MIRK4(), dt = 0.01)
plot(sol)</code></pre><img src="3d6fbe74.svg" alt="Example block output"/><p>Since this problem has less constraints than the state variables, so there would be infinitely many solutions with different <code>u0</code> specified.</p><p>The above underdetermined is also being able to reformulated as <code>TwoPointBVProblem</code></p><pre><code class="language-julia hljs">function f!(du, u, p, t)
    du[1] = u[2]
    du[2] = u[3]
    du[3] = u[4]
    du[4] = 0
end
bca!(resid, ua, p) = (resid[1] = ua[1])
bcb!(resid, ub, p) = (resid[1] = ub[1])
xspan = (0.0, 1.0)
u0 = [0.0, 1.0, 0.0, 1.0]
bvpfun = BVPFunction(f!, (bca!, bcb!); twopoint = Val(true),
    bcresid_prototype = ( zeros(1), zeros(1)))
prob = TwoPointBVProblem(bvpfun, u0, xspan)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi"><span class="sgr38_2" style="color:#56b6c2">BVProblem</span> with uType <span class="sgr38_2" style="color:#56b6c2">Vector{Float64}</span> and tType <span class="sgr38_2" style="color:#56b6c2">Float64</span>. In-place: <span class="sgr38_2" style="color:#56b6c2">true</span>
Non-trivial mass matrix: <span class="sgr38_2" style="color:#56b6c2">false</span>
timespan: (0.0, 1.0)
u0: 4-element Vector{Float64}:
 0.0
 1.0
 0.0
 1.0</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../continuation/">« Solve BVP with Continuation</a><a class="docs-footer-nextpage" href="../unknown_parameters/">Estimate Unknown Parameters in BVP »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.1 on <span class="colophon-date" title="Tuesday 10 February 2026 17:01">Tuesday 10 February 2026</span>. Using Julia version 1.10.10.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
