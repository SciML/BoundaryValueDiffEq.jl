<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Error Control Adaptivity · BoundaryValueDiffEq.jl</title><meta name="title" content="Error Control Adaptivity · BoundaryValueDiffEq.jl"/><meta property="og:title" content="Error Control Adaptivity · BoundaryValueDiffEq.jl"/><meta property="twitter:title" content="Error Control Adaptivity · BoundaryValueDiffEq.jl"/><meta name="description" content="Documentation for BoundaryValueDiffEq.jl."/><meta property="og:description" content="Documentation for BoundaryValueDiffEq.jl."/><meta property="twitter:description" content="Documentation for BoundaryValueDiffEq.jl."/><meta property="og:url" content="https://docs.sciml.ai/BoundaryValueDiffEq/stable/basics/error_control/"/><meta property="twitter:url" content="https://docs.sciml.ai/BoundaryValueDiffEq/stable/basics/error_control/"/><link rel="canonical" href="https://docs.sciml.ai/BoundaryValueDiffEq/stable/basics/error_control/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="BoundaryValueDiffEq.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">BoundaryValueDiffEq.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">BoundaryValueDiffEq.jl: High-Performance Bounday Value Problem Solvers</a></li><li><a class="tocitem" href="../../tutorials/getting_started/">Getting Started with BVP solving in Julia</a></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../../tutorials/continuation/">Solve BVP with Continuation</a></li><li><a class="tocitem" href="../../tutorials/solve_nlls_bvp/">Solve Overdetermined and Underdetermined BVP</a></li></ul></li><li><span class="tocitem">Basics</span><ul><li><a class="tocitem" href="../bvp_problem/">Boundary Value Problems</a></li><li><a class="tocitem" href="../bvp_functions/">BVP Functions and Jacobian Types</a></li><li><a class="tocitem" href="../solve/">Common Solver Options (Solve Keyword Arguments)</a></li><li><a class="tocitem" href="../autodiff/">Automatic Differentiation Backends</a></li><li class="is-active"><a class="tocitem" href>Error Control Adaptivity</a><ul class="internal"><li><a class="tocitem" href="#Error-control-methods"><span>Error control methods</span></a></li></ul></li></ul></li><li><span class="tocitem">Solver Summaries and Recommendations</span><ul><li><a class="tocitem" href="../../solvers/mirk/">BoundaryValueDiffEqMIRK</a></li><li><a class="tocitem" href="../../solvers/firk/">BoundaryValueDiffEqFIRK</a></li><li><a class="tocitem" href="../../solvers/shooting/">BoundaryValueDiffEqShooting</a></li><li><a class="tocitem" href="../../solvers/mirkn/">BoundaryValueDiffEqMIRKN</a></li><li><a class="tocitem" href="../../solvers/ascher/">BoundaryValueDiffEqAscher</a></li><li><a class="tocitem" href="../../solvers/simple_solvers/">SimpleBoundaryValueDiffEq</a></li><li><a class="tocitem" href="../../solvers/wrappers/">Wrapper Methods</a></li></ul></li><li><span class="tocitem">Wrapped Solver APIs</span><ul><li><a class="tocitem" href="../../api/odeinterface/">ODEInterface.jl</a></li></ul></li><li><span class="tocitem">Development Documentation</span><ul><li><a class="tocitem" href="../../devdocs/internal_interfaces/">Internal Abstract Types</a></li></ul></li><li><a class="tocitem" href="../../references/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Basics</a></li><li class="is-active"><a href>Error Control Adaptivity</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Error Control Adaptivity</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/SciML/BoundaryValueDiffEq.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/SciML/BoundaryValueDiffEq.jl/blob/master/docs/src/basics/error_control.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Error-Control-Adaptivity"><a class="docs-heading-anchor" href="#Error-Control-Adaptivity">Error Control Adaptivity</a><a id="Error-Control-Adaptivity-1"></a><a class="docs-heading-anchor-permalink" href="#Error-Control-Adaptivity" title="Permalink"></a></h1><p>Adaptivity helps ensure the quality of the our numerical solution, and when our solution exhibits significant estimating errors, adaptivity automatically refine the mesh based on the error distribution, and providing a final satisfying solution.</p><p>When comes to solving ill-conditioned BVP, for example the singular pertubation problem where the small parameters become extremally small leading to the layers phonemona, the error control adaptivity becomes even more critical, because the minor pertubations can lead to large deviation in the solution. In such cases, adaptivity autimatically figure out where to use refined mesh and where to use coarse mesh to achieve the balance of computational efficiency and accuracy.</p><p>BoundaryValuDiffEq.jl support error control adaptivity for collocation methods, and the adaptivity is default as defect control adaptivity when using adaptive collocation solvers:</p><pre><code class="language-julia hljs">sol = solve(prob, MIRK4(), dt = 0.01, adaptive = true)</code></pre><p>Actually, BoundaryValueDiffEq.jl supports both defect and global error control adaptivity(while the defect control is the default controller) <a href="../../references/#boisvert2013runge">Boisvert <em>et al.</em> [4]</a>, to specify different error control metods, we simply need to specify the <code>controller</code> keyword in <code>solve</code>:</p><pre><code class="language-julia hljs">sol = solve(prob, MIRK4(), dt = 0.01, controller = GlobalErrorControl()) # Use global error control
sol = solve(prob, MIRK4(), dt = 0.01, controller = SequentialErrorControl()) # Use Sequential error control
sol = solve(prob, MIRK4(), dt = 0.01, controller = HybridErrorControl()) # Use Hybrid error control</code></pre><h2 id="Error-control-methods"><a class="docs-heading-anchor" href="#Error-control-methods">Error control methods</a><a id="Error-control-methods-1"></a><a class="docs-heading-anchor-permalink" href="#Error-control-methods" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="BoundaryValueDiffEqCore.DefectControl" href="#BoundaryValueDiffEqCore.DefectControl"><code>BoundaryValueDiffEqCore.DefectControl</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">DefectControl(; defect_threshold = 0.1)</code></pre><p>Defect estimation method with defect defined as</p><p class="math-container">\[defect = \max\frac{S&#39;(x) - f(x,S(x))}{1 + |f(x,S(x))|}\]</p><p>Defect controller, with the maximum <code>defect_threshold</code> as 0.1, when the estimating defect is greater than the <code>defect_threshold</code>, the mesh will be refined.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SciML/BoundaryValueDiffEq.jl/blob/fe6d02503b66eccdfe08fc992dfd9cf523f04702/lib/BoundaryValueDiffEqCore/src/calc_errors.jl#L18-L28">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="BoundaryValueDiffEqCore.GlobalErrorControl" href="#BoundaryValueDiffEqCore.GlobalErrorControl"><code>BoundaryValueDiffEqCore.GlobalErrorControl</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">GlobalErrorControl(; method = HOErorControl())</code></pre><p>Global error controller, use high order global error estimation method <code>HOErrorControl</code> as default.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SciML/BoundaryValueDiffEq.jl/blob/fe6d02503b66eccdfe08fc992dfd9cf523f04702/lib/BoundaryValueDiffEqCore/src/calc_errors.jl#L37-L41">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="BoundaryValueDiffEqCore.SequentialErrorControl" href="#BoundaryValueDiffEqCore.SequentialErrorControl"><code>BoundaryValueDiffEqCore.SequentialErrorControl</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">SequentialErrorControl(; defect = DefectControl(), global_error = GlobalErrorControl())</code></pre><p>First use the defect controller, if the defect is satisfying, then use global error controller.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SciML/BoundaryValueDiffEq.jl/blob/fe6d02503b66eccdfe08fc992dfd9cf523f04702/lib/BoundaryValueDiffEqCore/src/calc_errors.jl#L50-L54">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="BoundaryValueDiffEqCore.HybridErrorControl" href="#BoundaryValueDiffEqCore.HybridErrorControl"><code>BoundaryValueDiffEqCore.HybridErrorControl</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">HybridErrorControl(; DE = 1.0, GE = 1.0, defect = DefectControl(), global_error = GlobalErrorControl())</code></pre><p>Control both of the defect and global error, where the error norm is the linear combination of the defect and global error.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SciML/BoundaryValueDiffEq.jl/blob/fe6d02503b66eccdfe08fc992dfd9cf523f04702/lib/BoundaryValueDiffEqCore/src/calc_errors.jl#L65-L69">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="BoundaryValueDiffEqCore.NoErrorControl" href="#BoundaryValueDiffEqCore.NoErrorControl"><code>BoundaryValueDiffEqCore.NoErrorControl</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">NoErrorControl()</code></pre><p>No error control method.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SciML/BoundaryValueDiffEq.jl/blob/fe6d02503b66eccdfe08fc992dfd9cf523f04702/lib/BoundaryValueDiffEqCore/src/calc_errors.jl#L82-L86">source</a></section></article><p>While we can achieve global error control in different ways, we can use different methods to estimate the global error:</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="BoundaryValueDiffEqCore.HOErrorControl" href="#BoundaryValueDiffEqCore.HOErrorControl"><code>BoundaryValueDiffEqCore.HOErrorControl</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">HOErrorControl()</code></pre><p>Higher order global error estimation method</p><p>Uses a solution from order+2 method on the original mesh and calculate the error with</p><p class="math-container">\[error = \max\frac{u_p - u_{p+2}}{1 + |u_p|}\]</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SciML/BoundaryValueDiffEq.jl/blob/fe6d02503b66eccdfe08fc992dfd9cf523f04702/lib/BoundaryValueDiffEqCore/src/calc_errors.jl#L89-L99">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="BoundaryValueDiffEqCore.REErrorControl" href="#BoundaryValueDiffEqCore.REErrorControl"><code>BoundaryValueDiffEqCore.REErrorControl</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">REErrorControl()</code></pre><p>Richardson extrapolation global error estimation method</p><p>Use Richardson extrapolation to calculate the error on the doubled mesh with</p><p class="math-container">\[error = \frac{2^p}{2^p-1} * \max\frac{u_h - u_{h/2}}{1 + |u_h|}\]</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SciML/BoundaryValueDiffEq.jl/blob/fe6d02503b66eccdfe08fc992dfd9cf523f04702/lib/BoundaryValueDiffEqCore/src/calc_errors.jl#L102-L112">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../autodiff/">« Automatic Differentiation Backends</a><a class="docs-footer-nextpage" href="../../solvers/mirk/">BoundaryValueDiffEqMIRK »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.10.2 on <span class="colophon-date" title="Thursday 8 May 2025 15:46">Thursday 8 May 2025</span>. Using Julia version 1.10.9.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
